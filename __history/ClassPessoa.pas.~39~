unit ClassPessoa;

interface

uses
  System.SysUtils, ClassSql;

type
  TPessoa = class
  private
    FNome: string;
    FEtnia: string;
    FDataNasc: String;
    FSexo: string;

    function GetNome: string;
    procedure SetNome(value: string);
    procedure SetEtnia(const value: string);
    function GetEtnia: string;
    procedure SetDataNasc(const value: String);
    function GetDataNasc: string;
    procedure SetSexo(const Value: string);
    function GetSexo: string;
  public
    function Idade: Integer;

    property nome: string read GetNome write SetNome;
    property Etnia: string read GetEtnia write SetEtnia;
    property DataNasc: String read FDataNasc write SetDataNasc;
    property Sexo: string read FSexo write SetSexo;
  end;

implementation

{ TPessoa }

function TPessoa.GetDataNasc: string;
begin
  Result := FDataNasc;
end;

function TPessoa.GetEtnia: string;
begin
  Result := FEtnia;
end;

function TPessoa.GetNome: string;
begin
  Result := FNome;
end;

function TPessoa.GetSexo: string;
begin
  Result := FSexo;
end;

function TPessoa.Idade: Integer;
begin
  Result := Trunc((Now - StrToDate(DataNasc)) / 365.25);
end;

procedure TPessoa.SetDataNasc(const value: String);
begin
  FDataNasc := value;
end;

procedure TPessoa.SetEtnia(const value: string);
begin
  if Length(value) = 0 then
    raise Exception.Create('Etnia não informado');
  FEtnia := value;
end;

procedure TPessoa.SetNome(value: string);
begin
  if Length(value) = 0 then
    raise Exception.Create('Nome não informado');

  FNome := value;
end;

procedure TPessoa.SetSexo(const Value: string);
begin
  FSexo := Value;
end;

end.
